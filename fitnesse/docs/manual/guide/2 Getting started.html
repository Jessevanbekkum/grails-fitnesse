<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
        <title>2 Getting started</title>
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Ref" charset="utf-8"/>
    </head>
    <body class="body">
    <h1><a name="2 Getting started">2 Getting started</a></h1>You can install the plugin by typing
<div class="code"><pre>$ grails install&#45;plugin fitnesse</pre></div><p class="paragraph"/>Now, whenever you start up your Grails application (using run-app for example), a Fitnesse server will also start internally, allowing the Fitnesse Wiki to connect to the Grails application.<p class="paragraph"/><blockquote class="note">
Note that currently you'll need to start up and close your Grails application yourself; the plugin doesn't do this for you. This might change in the future, but for now, it's a manual step.
</blockquote><p class="paragraph"/>The internal Fitnesse server allows connections made by the Fitnesse Wiki to be interpreted by Fixtures, which run against your application.<p class="paragraph"/><p class="paragraph"/><p class="paragraph"/><p class="paragraph"/>
<h2><a name="2.1 Quickstart">2.1 Quickstart</a></h2>For the impatient, this is the quickstart to get Fitnesse to work with Grails.<p class="paragraph"/><h3>Step 1: Install the Fitnesse Plugin</h3>
<div class="code"><pre>grails install&#45;plugin fitnesse</pre></div><p class="paragraph"/><h3>Step 2: Download Fitnesse</h3>
Go to the <a href="http://www.fitnesse.org" target="blank">Fitnesse</a> website, to download Fitnesse.<p class="paragraph"/><h3>Step 3: Start the Grails application</h3>
<div class="code"><pre>grails run&#45;app</pre></div><p class="paragraph"/><h3>Step 4 (in a differtent console or terminal): Start Fitnesse</h3>
<div class="code"><pre>grails run&#45;fitnesse</pre></div><p class="paragraph"/><h3>Step 5: Configure Fitnesse (for Linux/MacOS)</h3><p class="paragraph"/>Paste the following in the Fitnesse wiki:
<div class="code"><pre>!define TEST_SYSTEM &#123;slim&#125;
!define COMMAND_PATTERN &#123;echo&#125;</pre></div><p class="paragraph"/><blockquote class="note">
The COMMAND_PATTERN needs to be something which executes, but does noting. On Windows for example this can an empty batch file.
</blockquote><p class="paragraph"/><h3>Step 6: Add the Test</h3>
Paste the following also in the Fitnesse wiki:
<div class="code"><pre>|<span class="java&#45;keyword">import</span>                         |
|nl.jworks.fitnesse.demo.fixture|<p class="paragraph"/>|echo|
|input|output?|
|hello|  hello|
|world|  world|</pre></div><p class="paragraph"/><strong class="bold">Save</strong> the page.<p class="paragraph"/><h3>Step 7: Verify it works</h3><p class="paragraph"/>Click on <strong class="bold">Properties</strong>, select <strong class="bold">Test</strong> for '<code>Page type</code>', click on <strong class="bold">Save properties</strong> to save the page.<p class="paragraph"/>Now press <strong class="bold">Test</strong>. Everything should be Green now!<h2><a name="2.2 Fixtures">2.2 Fixtures</a></h2>Fitnesse Fixtures, not to be confused with <a href="http://www.grails.org/plugin/fixtures" target="blank">Grails Fixtures</a>, allow a bridge between the Fitnesse Wiki and the System Under Test (SUT).<p class="paragraph"/>Fixtures are similar to Grails artifacts and share most of their characteristics, like hot reloading and Dependency Injection. All Fixtures should be created in the 'Fitnesse' directory in the <code>grails-app</code> directory.<p class="paragraph"/><h4>Example</h4><p class="paragraph"/>Below you'll find an example Wiki test plus the Fixture which will serve as the bridge between the Wiki and the SUT.<p class="paragraph"/>Wiki:
<div class="code"><pre>|loan calculator       |
|income|debts|category?|
|10000 |500  |A        |
|5000  |10000|C        |</pre></div><p class="paragraph"/>And the Fixture:<p class="paragraph"/><div class="code"><pre>class LoanCalculatorFixture &#123;
    // Input parameters
    <span class="java&#45;object">int</span> income
    <span class="java&#45;object">int</span> debts<p class="paragraph"/>    // Output parameter
    <span class="java&#45;object">String</span> category<p class="paragraph"/>    // Dependency Injected
    def loanCalculationService<p class="paragraph"/>    void execute() &#123;
        <span class="java&#45;keyword">this</span>.category = loanCalculationService.calculateLoanCategory(income, debts)
    &#125;
&#125;</pre></div><p class="paragraph"/><strong class="bold">Explanation</strong><p class="paragraph"/>The Wiki Tests consists of 3 parts:
<ul class="star">
<li>the fixture name (<code>loan calculator</code>)</li>
<li>the header(income, debts, and category)</li>
<li>and the body (the rest of the table). As you can see, <code>category</code> is suffixed with a question mark to indicate this is not a value to be set, but rather to be read ('get'). As such, first the input values are set, then the execute method is called by Fitnesse, and finally the output are called, in this case category.</li>
</ul><p class="paragraph"/><blockquote class="note">
A small note: normally output parameters are 'functions' and not getters. This means you would need an extra method for the output parameters. In the Grails version of the Fitnesse runner, this isn't necessary (fortunately!), and Fitnesse will check both the 'functions' as well as the Groovy properties. Less code to write, less code to maintain!
</blockquote><p class="paragraph"/><h2><a name="2.3 Wiki">2.3 Wiki</a></h2>The Wiki contains all the tests. The wiki consists of two parts:
<ul class="star">
<li>Formatted text</li>
<li>Tables</li>
</ul><p class="paragraph"/>Tables are the tests, and only tables are executed.<p class="paragraph"/>The following tests are at least supported by the Grails Fitnesse plugin:<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">Name</strong></th><th><strong class="bold">Description</strong></th></tr><tr class="table-odd"><td>Decision Table</td><td>Supplies the inputs and outputs for decisions.  This is similar to the Fit Column Fixture</td></tr><tr class="table-even"><td>Query Table</td><td>Supplies the expected results of a query.  This is similar to the Fit Row Fixture</td></tr><tr class="table-odd"><td>Script Table</td><td>A series of actions and checks. Similar to Do Fixture.</td></tr><tr class="table-even"><td>Import</td><td>Add a path to the fixture search path.</td></tr></table><p class="paragraph"/>The following tables might work, but at the moment, they haven't been tested yet. They are included here for completeness.<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">Name</strong></th><th><strong class="bold">Description</strong></th></tr><tr class="table-odd"><td>Table Table</td><td>Whatever you want it to be!</td></tr><tr class="table-even"><td>Subset Query Table</td><td>Supplies a subset of the expected results of a query.</td></tr><tr class="table-odd"><td>Ordered query Table</td><td>Supplies the expected results of a query.  The rows are expected to be in order.  This is similar to the Fit Row Fixture</td></tr><tr class="table-even"><td>Comment</td><td>A table that does nothing.</td></tr><tr class="table-odd"><td>Scenario Table</td><td>A table that can be called from other tables.</td></tr><tr class="table-even"><td>Library Table</td><td>A table that installs fixtures available for all test pages</td></tr></table><p class="paragraph"/>For more information, please check out the Fitnesse Slim documentation on <a href="http://fitnesse.org/FitNesse.UserGuide.SliM" target="blank">Test Tables</a>.<h2><a name="2.4 Testrunner">2.4 Testrunner</a></h2>The Fitnesse Plugin can be used when testing your application from the command line by using the bundled testrunner. The testrunner can be launced by typing:<p class="paragraph"/><div class="code"><pre>grails test&#45;app integration:fitnesse &#60;name of suite or test&#62;</pre></div><p class="paragraph"/>An example of this can be found below:<p class="paragraph"/><div class="code"><pre>grails test&#45;app integration:fitnesse <span class="java&#45;quote">"FrontPage.GrailsTestSuite.SlimTestSystem?suite"</span></pre></div><p class="paragraph"/>It is also possbible to run multiple tests or suites. This can done by appending the suite or tests names:<p class="paragraph"/><div class="code"><pre>grails test&#45;app integration:fitnesse <span class="java&#45;quote">"FrontPage.GrailsTestSuite.FirstSuite?suite"</span> <span class="java&#45;quote">"FrontPage.GrailsTestSuite.SecondSuite?suite"</span></pre></div><p class="paragraph"/>Running these commands will start up the Grails application, launch the Fitnesse tests, and return the results in a standard Grails test report.<p class="paragraph"/><h3>Run sequence</h3><p class="paragraph"/>The default Wiki Suite or Test which will be run using <code>grails test-app</code> will be determined in the following way:
<ol>
<li>First, if a suite or test is specified as an argument to <code>grails test-app</code>, the argument will be used</li>
<li>Second, if a suite or test is specified in the Config.groovy, that one will be used</li>
<li>Thirdly, all tests defined on the Fitnesse Frontpage (FrontPage?suite) will be run if none of the above options are applicable</li>
</ol><p class="paragraph"/>
    </body>
</html>
